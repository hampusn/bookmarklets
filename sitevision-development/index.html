<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sitevision development</title>
    <meta name="description" content="Easy toggling of Profiling, JSDebug and Version.">
    <link rel="stylesheet" href="/assets/css/main.css?v=0.12.1">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  </head>
  <body class="template-bookmarklet ">
    <div class="page is-flex is-flex-direction-column">
      <header class="page-header">
        <nav class="navbar is-primary" role="navigation" aria-label="main navigation">
          <div class="navbar-brand">
            <a class="home-item navbar-item" href="/">
              <svg class="home-item__icon icon" aria-hidden="true"><use href="/assets/img/icons.svg?v=0.12.1#mdi-bookmark-multiple"></use></svg>
              <span class="home-item__text is-family-secondary pr-4">Bookmarklets</span>
            </a>

            <button type="button" class="navbar-burger" aria-label="Menu" aria-expanded="false" data-target="menu">
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </button>
          </div>

          <div id="menu" class="navbar-menu">
            <div class="navbar-end">
              <div class="navbar-item">
                <div class="buttons">
                  <a class="button is-secondary" href="https://github.com/hampusn/bookmarklets#readme">
                    <svg class="icon" aria-hidden="true"><use href="/assets/img/icons.svg?v=0.12.1#mdi-github"></use></svg>
                    <strong>Github</strong>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </nav>
      </header><!--! .page-header -->

      <main class="page-main is-flex-grow-1 ">
        

        <div class="section">
  <div class="container is-max-desktop">
    <div class="content">
      <h1 class="is-family-secondary">Sitevision development</h1><p>This bookmarklet toggles three handy Sitevision functionalities:</p>
<ul>
<li><strong>Profiling</strong>: Displays a table with render times for all portlets and modules on the page, allowing you to evaluate performance.</li>
<li><strong>JSDebug</strong>: Disables asset minification and bundling, revealing the original filenames for stylesheets (CSS) and client scripts (JavaScript), useful for pinpointing source files.</li>
<li><strong>Version</strong>: Switches the view to the offline version of the page, showing the draft in the CMS without the editor interface. Ideal for previewing unpublished content.</li>
</ul>
<p><em>The Version switch is only shown when you are logged in since the offline version requires you to be authenticated.</em></p>
<div class="overlap-images">
  <img src="/sitevision-development/sitevision-development-1.png" alt="Screenshot with the bookmarklet's modal in view." />
  <img src="/sitevision-development/sitevision-development-2.png" alt="Screenshot with profiling activated." />
</div>

    </div>
  </div>
</div>

<div class="section has-background-light">
  <div class="container is-max-desktop">
    <dl class="block is-flex-desktop is-flex-wrap-wrap is-justify-content-center">
      <div class="is-flex mx-3 my-1">
        <dt class="has-text-weight-semibold mr-2">Created</dt>
        <dd>2024-10-20</dd>
      </div>

      

      <div class="is-flex mx-3 my-1">
        <dt class="has-text-weight-semibold mr-2">Bookmarklet size</dt>
        <dd>9.32 kB</dd>
      </div>
    </dl>

    <div class="has-text-centered-desktop my-6">
      <p class="is-size-5 mb-2">Drag this link to your bookmarks to save it.</p>
      <a class="bookmarklet-button button is-link is-medium" href="javascript:!function()%7B%22use%20strict%22%3Bconst%20e%3Dwindow.document%3Bfunction%20i(i)%7Bconst%20t%3De.createElement(%22template%22)%3Breturn%20t.innerHTML%3Di%2Ct.content.firstElementChild%7Dconst%20t%3D%22click%22%2Cn%3D(e%2Ci%2Ct)%3D%3Ee.addEventListener(i%2Ct)%3Bvar%20s%3D(e%2Ci)%3D%3En(e%2Ct%2Ci)%2Cl%3D(e%2Ci)%3D%3En(e%2C%22change%22%2Ci)%3Bconst%20o%3D%22env-modal-dialog%22%2Ca%3D%22env-spinner-bounce%22%2Cd%3Dwindow.document%2Cc%3Dwindow.envision%3Bclass%20h%7Bconstructor(%7BdialogId%3Ae%2Ctitle%3Ai%2Csize%3At%2CcloseText%3An%3D%22Close%22%7D)%7Bthis.id%3De%2Cthis.isLoading%3D!1%2Cthis.isDisabled%3D!1%2Cthis.title%3Di%2Cthis.size%3Dt%2Cthis.closeText%3Dn%2Cthis.context%3D%7B%7D%2Cthis.tid%3De%2B%22-t%22%2Cthis.thid%3De%2B%22-th%22%2Cthis.cid%3De%2B%22-c%22%2Cthis.eid%3De%2B%22-e%22%2Cthis.fid%3De%2B%22-f%22%2Cthis.lid%3De%2B%22-l%22%7Del(e)%7Breturn%20d.getElementById(e)%7Dasync%20init(e)%7Bconst%20i%3Dthis.id%2Ct%3Dthis.tid%3Bif(this.el(i))return%20this%3Blet%20n%3Btry%7Be%3D%22function%22%3D%3Dtypeof%20e%3Fawait%20e.call(null%2Cthis)%3Ae%7Dcatch(e)%7Bn%3De%7Dconst%20l%3D%22string%22%3D%3Dtypeof%20e%3Fe%3A%22%22%2Cc%3Dthis.size%3F%60%24%7Bo%7D__dialog--%24%7Bthis.size%7D%60%3A%22%22%3Breturn%20d.body.insertAdjacentHTML(%22beforeend%22%2C%60%3Cdiv%20id%3D%22%24%7Bi%7D%22%20class%3D%22%24%7Bo%7D%20%24%7Bo%7D--inner-scroll%22%20style%3D%22z-index%3A99999%22%20role%3D%22dialog%22%20aria-modal%3D%22true%22%20aria-labelledby%3D%22%24%7Bt%7D%22%20aria-hidden%3D%22true%22%20tabindex%3D%22-1%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class%3D%22%24%7Bo%7D__dialog%20%24%7Bc%7D%22%3E%5Cn%20%20%20%20%20%20%20%20%3Csection%20class%3D%22%24%7Bo%7D__content%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cheader%20class%3D%22%24%7Bo%7D__header%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Ch5%20id%3D%22%24%7Bt%7D%22%20class%3D%22env-text%20env-d--flex%20env-flex--align-items-center%20env-flex--justify-content-between%20%24%7Bo%7D__header__title%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20id%3D%22%24%7Bthis.thid%7D%22%3E%24%7Bthis.title%7D%3C%2Fspan%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22%24%7Bthis.lid%7D%22%20class%3D%22%24%7Ba%7D%20%24%7Ba%7D--hide%20%24%7Ba%7D--fade-in%22%20data-delay%3D%22medium%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24%7B%5B1%2C2%2C3%5D.map((e%3D%3E%60%3Cdiv%20class%3D%22env-bounce%24%7Be%7D%22%3E%3C%2Fdiv%3E%60)).join(%22%22)%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fh5%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C%2Fheader%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22%24%7Bo%7D__body%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22%24%7Bthis.cid%7D%22%3E%24%7Bl%7D%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22%24%7Bthis.eid%7D%22%20class%3D%22env-alert%20env-alert--danger%22%20hidden%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20data-error-holder%3E%3C%2Fspan%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20type%3D%22button%22%20class%3D%22env-alert__close%20env-button%20env-button--link%20env-button--icon%20env-button--icon-small%22%20data-dismiss%3D%22alert%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Close%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Csvg%20class%3D%22env-icon%20env-icon--xx-small%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cuse%20href%3D%22%2Fsitevision%2Fenvision-icons.svg%23icon-delete%22%3E%3C%2Fuse%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fsvg%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fbutton%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cfooter%20id%3D%22%24%7Bthis.fid%7D%22%20class%3D%22%24%7Bo%7D__footer%20env-d--flex%20env-flex--justify-content-between%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20type%3D%22button%22%20data-modal-dialog-dismiss%20class%3D%22env-button%20env-m-left--a%22%3E%24%7Bthis.closeText%7D%3C%2Fbutton%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C%2Ffooter%3E%5Cn%20%20%20%20%20%20%20%20%3C%2Fsection%3E%5Cn%20%20%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%20%20%3C%2Fdiv%3E%60)%2Cn%26%26this.renderError(n)%2Cs(this.el(this.eid).querySelector(&#39;%5Bdata-dismiss%3D%22alert%22%5D&#39;)%2C(()%3D%3E%7Bthis.renderError(%22%22)%7D))%2Ce%20instanceof%20HTMLElement%26%26this.el(this.cid).appendChild(e)%2Cthis%7DisOpen()%7Breturn%20this.el(this.id)%3F.classList.contains(%22env-modal-dialog--show%22)%7DupdateTitle(e)%7Bthis.title%3De%2Cthis.el(this.thid).innerHTML%3De%7DupdateContent(e)%7Bthis.el(this.cid).innerHTML%3De%7DsetLoading(e)%7Bthis.isLoading%3D!!e%2Cthis.el(this.lid).classList.toggle(%60%24%7Ba%7D--hide%60%2C!this.isLoading)%7DsetDisabled(e)%7Bthis.isDisabled%3D!!e%2Cthis.el(this.id).inert%3Dthis.isDisabled%2Cthis.el(this.cid).style.opacity%3Dthis.isDisabled%3F.5%3A1%2Cthis.el(this.fid).querySelectorAll(%22.env-button%22).forEach((e%3D%3Ee.disabled%3Dthis.isDisabled))%7DrenderError(e)%7Bconst%20i%3D!!e%2Ct%3Dthis.el(this.eid)%3Bt.querySelector(%22%5Bdata-error-holder%5D%22).innerHTML%3De%2Ct.hidden%3D!i%2Cthis.el(this.cid).hidden%3Di%7DonClose(e)%7Breturn%22function%22%3D%3Dtypeof%20e%26%26jQuery(%22%23%22%2Bthis.id).on(%22hide.env-modal-dialog%22%2C(i%3D%3E%7Be.call(null%2Cthis%2Ci)%7D))%2Cthis%7DonClosed(e)%7Breturn%22function%22%3D%3Dtypeof%20e%26%26jQuery(%22%23%22%2Bthis.id).on(%22hidden.env-modal-dialog%22%2C(i%3D%3E%7Be.call(null%2Cthis%2Ci)%7D))%2Cthis%7Dhide(e)%7Breturn%20c.dialog(%22%23%22%2Bthis.id%2C%22hide%22).then(e%3Fe.bind(null%2Cthis)%3Anull)%2Cthis%7Dtoggle(e)%7Breturn%20c.dialog(%22%23%22%2Bthis.id%2C%22toggle%22).then(e%3Fe.bind(null%2Cthis)%3Anull)%2Cthis%7Dremove()%7Bthis.el(this.id).remove()%7D%7Dconst%20r%3D(e%2Ci%3D%7B%7D)%3D%3E%7Bconst%20t%3D((e%3Dnull)%3D%3E%7Bconst%20i%3Dwindow.__BookmarkletDialogInstances%3Dwindow.__BookmarkletDialogInstances%7C%7C%7B%7D%3Breturn%20e%3Fi%5Be%5D%3Ai%7D)()%3Breturn%20t%5Be%5D%7C%7C(t%5Be%5D%3Dnew%20h(%7B...i%2CdialogId%3Ae%7D))%2Ct%5Be%5D%7D%3Bclass%20u%7Bconstructor(%7Blabel%3Ae%2Cdescription%3Ai%2CchangeCallback%3At%2CcheckCallback%3An%7D)%7Bthis.label%3De%2Cthis.description%3Di%2Cthis.changeCallback%3Dt%2Cthis.checkCallback%3Dn%2Cthis.el%3Dnull%2Cthis.id%3D%22-%22%2BMath.random().toString(36).slice(2%2C11)%2Cthis.init()%7Dcheck()%7Breturn!!this.checkCallback.call(null%2Cthis)%7Dinit()%7Bconst%20e%3Dthis.check()%3F%22checked%22%3A%22%22%2Ct%3Dthis.description%3F%60%3Cp%20class%3D%22env-text%22%20style%3D%22margin%3A%200%200%20var(--env-spacing-x-large)%20calc(2.625em%20%2B%20var(--env-spacing-x-small))%22%3E%24%7Bthis.description%7D%3C%2Fp%3E%60%3A%22%22%3Bthis.el%3Di(%60%3Cdiv%20class%3D%22env-form-field%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class%3D%22env-form-control%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20class%3D%22env-switch%22%20type%3D%22checkbox%22%20id%3D%22%24%7Bthis.id%7D%22%20name%3D%22switches%22%20%24%7Be%7D%20%2F%3E%5Cn%20%20%20%20%20%20%20%20%3Clabel%20class%3D%22env-form-label%22%20for%3D%22%24%7Bthis.id%7D%22%3E%24%7Bthis.label%7D%3C%2Flabel%3E%5Cn%20%20%20%20%20%20%3C%2Fdiv%3E%5Cn%20%20%20%20%20%20%24%7Bt%7D%5Cn%20%20%20%20%3C%2Fdiv%3E%60)%2Cl(this.el.querySelector(%22input%22)%2C(e%3D%3Ethis.changeCallback.call(null%2Cthis%2Ce)))%7DappendTo(e)%7Be.appendChild(this.el)%7D%7D((e%2Ct)%3D%3E%7Bif(!e.envision)return%20void%20console.warn(%22Envision%20not%20found.%20Exiting%20since%20most%20likely%20not%20Sitevision.%22)%3Bconst%20n%3De.location%2Cs%3De%3D%3Et.querySelector(e)%2Cl%3D()%3D%3Enew%20URLSearchParams(n.search)%2Co%3D(e%2Ci)%3D%3E%7Bconst%20t%3Dl()%3Bt.set(e%2Ci)%2Cn.search%3Dt%7D%3Br(%22sitevision-development-dialog%22%2C%7Btitle%3A%22Sitevision%20development%22%7D).init((()%3D%3E%7Bconst%20e%3D%22profiling%22%2Ca%3D%22jsdebug%22%2Cd%3D%22version%22%2Cc%3Di(%22%3Cdiv%3E%3C%2Fdiv%3E%22)%3Breturn%20new%20u(%7Blabel%3A%22Profiling%22%2Cdescription%3A%22Shows%20a%20table%20with%20render%20times%20of%20all%20portlets%20on%20page.%22%2CchangeCallback(i%2Ct)%7Bo(e%2C!i.check())%7D%2CcheckCallback()%7Bconst%20i%3Dl()%3Breturn%20i.has(e)%3F%22true%22%3D%3D%3Di.get(e)%3As(%22body%20%3E%20div%3Anot(.sv-layout)%20%3E%20table%22)%3F.textContent.trim().startsWith(%22Profiling%22)%7D%7D).appendTo(c)%2Cnew%20u(%7Blabel%3A%22Javascript%20Debug%22%2Cdescription%3A%22Disables%20minification%20and%20bundling%20of%20stylesheets%20and%20client%20scripts.%22%2CchangeCallback(e%2Ci)%7Bo(a%2C!e.check())%7D%2CcheckCallback()%7Bconst%20e%3Dl()%3Breturn%20e.has(a)%3F%22true%22%3D%3D%3De.get(a)%3A!(s(&#39;body%20%3E%20script%5Bsrc%24%3D%22%2Fwebapp-assets.js%22%5D&#39;)%7C%7Cs(&#39;head%20%3E%20link%5Bhref%24%3D%22sv-template-asset.css%22%5D&#39;))%7D%7D).appendTo(c)%2C(t.body.classList.contains(%22sv-editing-mode%22)%7C%7Cs(&#39;body%20%3E%20iframe%5Bsrc*%3D%22%2Fedit-editormenu%2F%22%5D&#39;))%26%26new%20u(%7Blabel%3A%22Offline%20verison%22%2Cdescription%3A%22View%20the%20version%20used%20when%20editing%20in%20the%20Sitevision%20editor%2C%20but%20without%20the%20editor%20interface.%22%2CchangeCallback(e%2Ci)%7Bconst%20t%3Dl()%3Be.check()%3Ft.delete(d)%3At.set(d%2C%220%22)%2Cn.search%3Dt%7D%2CcheckCallback%3A()%3D%3E%220%22%3D%3D%3Dl().get(d)%7D).appendTo(c)%2Cc%7D)).toggle()%7D)(window%2Cwindow.document)%7D()%3B">
        <svg class="bookmarklet__icon bookmarklet__icon icon" aria-hidden="true"><use href="/assets/img/icons.svg?v=0.12.1#mdi-bookmark"></use></svg>
        <svg class="bookmarklet__icon bookmarklet__icon--error icon" aria-hidden="true"><use href="/assets/img/icons.svg?v=0.12.1#mdi-block-helper"></use></svg>
        <svg class="bookmarklet__icon bookmarklet__icon--success icon" aria-hidden="true"><use href="/assets/img/icons.svg?v=0.12.1#mdi-check-bold"></use></svg>
        <span>Sitevision development</span>
      </a>
    </div>

    <div class="mt-6">
      <h2 class="is-size-4 is-family-secondary">Bookmarklet code</h2><div class="mb-6">
          <h3 class="is-size-5">sitevision-development</h3>
          <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> createElement <span class="token keyword">from</span> <span class="token string">'../../_lib/shared/create-element'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> getInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../_lib/shared/Dialog'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> Switch <span class="token keyword">from</span> <span class="token string">'../../_lib/shared/Switch'</span><span class="token punctuation">;</span><br><br><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">window<span class="token punctuation">,</span> document</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">// Bail early if envision is not found.</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>envision<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Envision not found. Exiting since most likely not Sitevision.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">const</span> <span class="token constant">LOCATION</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token function-variable function">getElement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token operator">=></span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token function-variable function">getSearchParams</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token constant">LOCATION</span><span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token function-variable function">updateSearchParam</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">param<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> searchParams <span class="token operator">=</span> <span class="token function">getSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    searchParams<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token constant">LOCATION</span><span class="token punctuation">.</span>search <span class="token operator">=</span> searchParams<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'sitevision-development-dialog'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'Sitevision development'</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> <span class="token constant">PROFILING_PARAM</span> <span class="token operator">=</span> <span class="token string">'profiling'</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> <span class="token constant">JSDEBUG_PARAM</span> <span class="token operator">=</span> <span class="token string">'jsdebug'</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> <span class="token constant">VERSION_PARAM</span> <span class="token operator">=</span> <span class="token string">'version'</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> switchesContainer <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'&lt;div>&lt;/div>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <br>      <span class="token keyword">new</span> <span class="token class-name">Switch</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>        <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'Profiling'</span><span class="token punctuation">,</span><br>        <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Shows a table with render times of all portlets on page.'</span><span class="token punctuation">,</span><br>        <span class="token function">changeCallback</span> <span class="token punctuation">(</span><span class="token parameter">instance<span class="token punctuation">,</span> e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token function">updateSearchParam</span><span class="token punctuation">(</span><span class="token constant">PROFILING_PARAM</span><span class="token punctuation">,</span> <span class="token operator">!</span>instance<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token function">checkCallback</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token keyword">const</span> searchParams <span class="token operator">=</span> <span class="token function">getSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>searchParams<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token constant">PROFILING_PARAM</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">PROFILING_PARAM</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'true'</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>          <br>          <span class="token comment">// Profiling is active if a table exist at the top of body and contains the text "Profiling".</span><br>          <span class="token keyword">return</span> <span class="token function">getElement</span><span class="token punctuation">(</span><span class="token string">'body > div:not(.sv-layout) > table'</span><span class="token punctuation">)</span><span class="token operator">?.</span>textContent<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'Profiling'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span>switchesContainer<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>      <span class="token keyword">new</span> <span class="token class-name">Switch</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>        <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'Javascript Debug'</span><span class="token punctuation">,</span><br>        <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Disables minification and bundling of stylesheets and client scripts.'</span><span class="token punctuation">,</span><br>        <span class="token function">changeCallback</span> <span class="token punctuation">(</span><span class="token parameter">instance<span class="token punctuation">,</span> e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token function">updateSearchParam</span><span class="token punctuation">(</span><span class="token constant">JSDEBUG_PARAM</span><span class="token punctuation">,</span> <span class="token operator">!</span>instance<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token function">checkCallback</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token keyword">const</span> searchParams <span class="token operator">=</span> <span class="token function">getSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>searchParams<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token constant">JSDEBUG_PARAM</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">JSDEBUG_PARAM</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'true'</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br><br>          <span class="token comment">// Javascript Debug is deemed to be active if bundle files webapp-assets.js (requires at least one webapp visible)</span><br>          <span class="token comment">// and sv-template-asset.css (requires at least one css file on page/template).</span><br>          <span class="token comment">// Will fail if no custom css or webapp exists on the rendered page.</span><br>          <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><br>               <span class="token function">getElement</span><span class="token punctuation">(</span><span class="token string">'body > script[src$="/webapp-assets.js"]'</span><span class="token punctuation">)</span><br>            <span class="token operator">||</span> <span class="token function">getElement</span><span class="token punctuation">(</span><span class="token string">'head > link[href$="sv-template-asset.css"]'</span><span class="token punctuation">)</span><br>          <span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span>switchesContainer<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>      <span class="token comment">// Offline version is only usable by authenticated users.</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">'sv-editing-mode'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">getElement</span><span class="token punctuation">(</span><span class="token string">'body > iframe[src*="/edit-editormenu/"]'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">new</span> <span class="token class-name">Switch</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>          <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">'Offline verison'</span><span class="token punctuation">,</span><br>          <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'View the version used when editing in the Sitevision editor, but without the editor interface.'</span><span class="token punctuation">,</span><br>          <span class="token function">changeCallback</span> <span class="token punctuation">(</span><span class="token parameter">instance<span class="token punctuation">,</span> e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">const</span> searchParams <span class="token operator">=</span> <span class="token function">getSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>              searchParams<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token constant">VERSION_PARAM</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>              searchParams<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token constant">VERSION_PARAM</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>  <br>            <span class="token constant">LOCATION</span><span class="token punctuation">.</span>search <span class="token operator">=</span> searchParams<span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><span class="token punctuation">,</span><br>          <span class="token function">checkCallback</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> <span class="token function">getSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">VERSION_PARAM</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'0'</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span>switchesContainer<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token keyword">return</span> switchesContainer<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> window<span class="token punctuation">.</span>document<span class="token punctuation">)</span></code></pre>
        </div><div class="mb-6">
          <h3 class="is-size-5">create-element.js</h3>
          <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token constant">DOCUMENT</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>document<span class="token punctuation">;</span><br><span class="token comment">// const ENVISION = window.envision;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token parameter">markup</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token constant">DOCUMENT</span><span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'template'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  template<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> markup<span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> template<span class="token punctuation">.</span>content<span class="token punctuation">.</span>firstElementChild<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
        </div><div class="mb-6">
          <h3 class="is-size-5">Events.js</h3>
          <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token constant">CLICK</span> <span class="token operator">=</span> <span class="token string">'click'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">CHANGE</span> <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">INPUT</span> <span class="token operator">=</span> <span class="token string">'input'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">KEYDOWN</span> <span class="token operator">=</span> <span class="token string">'keydown'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">SUBMIT</span> <span class="token operator">=</span> <span class="token string">'submit'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">PASTE</span> <span class="token operator">=</span> <span class="token string">'paste'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> event<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token function-variable function">remove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> event<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><br>  <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">add</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token constant">CLICK</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function-variable function">offClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">remove</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token constant">CLICK</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function-variable function">onChange</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">add</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token constant">CHANGE</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function-variable function">onInput</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">add</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token constant">INPUT</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function-variable function">onKeydown</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">add</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token constant">KEYDOWN</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">add</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token constant">SUBMIT</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function-variable function">onPaste</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">add</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token constant">PASTE</span><span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
        </div><div class="mb-6">
          <h3 class="is-size-5">Dialog.js</h3>
          <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Events <span class="token keyword">from</span> <span class="token string">"./Events"</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token constant">CLASS_BASE</span> <span class="token operator">=</span> <span class="token string">'env-modal-dialog'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">SPINNER_CLASS</span> <span class="token operator">=</span> <span class="token string">'env-spinner-bounce'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">DOCUMENT</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>document<span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">ENVISION</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>envision<span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * Creates the HTML markup for an envision dialog.<br> * <br> * @param {object} options An object literal with options.<br> * @param {string} options.dialogId A unique html ID for the dialog.<br> * @param {string} options.title<br> * @returns {string}<br> */</span><br><br><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Dialog</span> <span class="token punctuation">{</span><br>  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> dialogId<span class="token punctuation">,</span> title<span class="token punctuation">,</span> size<span class="token punctuation">,</span> closeText <span class="token operator">=</span> <span class="token string">'Close'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> dialogId<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>isDisabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">=</span> size<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>closeText <span class="token operator">=</span> closeText<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <br>    <span class="token keyword">this</span><span class="token punctuation">.</span>tid <span class="token operator">=</span> dialogId <span class="token operator">+</span> <span class="token string">'-t'</span><span class="token punctuation">;</span> <span class="token comment">// title</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>thid <span class="token operator">=</span> dialogId <span class="token operator">+</span> <span class="token string">'-th'</span><span class="token punctuation">;</span> <span class="token comment">// title holder</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>cid <span class="token operator">=</span> dialogId <span class="token operator">+</span> <span class="token string">'-c'</span><span class="token punctuation">;</span> <span class="token comment">// content</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>eid <span class="token operator">=</span> dialogId <span class="token operator">+</span> <span class="token string">'-e'</span><span class="token punctuation">;</span> <span class="token comment">// error</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>fid <span class="token operator">=</span> dialogId <span class="token operator">+</span> <span class="token string">'-f'</span><span class="token punctuation">;</span> <span class="token comment">// footer</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>lid <span class="token operator">=</span> dialogId <span class="token operator">+</span> <span class="token string">'-l'</span><span class="token punctuation">;</span> <span class="token comment">// loader</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">/**<br>   * Shortcut for Document.getElementById() for improved minification.<br>   * <br>   * @param {string} id An identifier for an HTMLElement.<br>   * @returns {(HTMLElement|null)}<br>   */</span><br>  <span class="token function">el</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token constant">DOCUMENT</span><span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <br><br>  <span class="token comment">/**<br>   * Initializes the dialog if it hasn't already been initialized.<br>   * <br>   * @param {(Function|String|HTMLElement)} initialContent <br>   * @returns {Dialog} Returns self for chainability.<br>   */</span><br>  <span class="token keyword">async</span> <span class="token function">init</span> <span class="token punctuation">(</span><span class="token parameter">initialContent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dialogId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> titleId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tid<span class="token punctuation">;</span><br>  <br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span>dialogId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">let</span> initialContentError<span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>      initialContent <span class="token operator">=</span> <span class="token keyword">typeof</span> initialContent <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token keyword">await</span> <span class="token function">initialContent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">:</span> initialContent<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      initialContentError <span class="token operator">=</span> e<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">const</span> contentString <span class="token operator">=</span> <span class="token keyword">typeof</span> initialContent <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">?</span> initialContent <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> sizeClass <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">__dialog--</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <br>    <span class="token comment">// Insert dialog into end of body and show dialog with envision.</span><br>    <span class="token constant">DOCUMENT</span><span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">'beforeend'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><br>    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dialogId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">--inner-scroll" style="z-index:99999" role="dialog" aria-modal="true" aria-labelledby="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>titleId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" aria-hidden="true" tabindex="-1"><br>      &lt;div class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">__dialog </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sizeClass<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"><br>        &lt;section class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">__content"><br>          &lt;header class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">__header"><br>            &lt;h5 id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>titleId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" class="env-text env-d--flex env-flex--align-items-center env-flex--justify-content-between </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">__header__title"><br>              &lt;span id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>thid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/span><br>              &lt;div id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>lid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SPINNER_CLASS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SPINNER_CLASS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">--hide </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SPINNER_CLASS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">--fade-in" data-delay="medium"><br>                </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div class="env-bounce</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">&lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>              &lt;/div><br>            &lt;/h5><br>          &lt;/header><br>          &lt;div class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">__body"><br>            &lt;div id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>cid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>contentString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div><br>            &lt;div id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>eid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" class="env-alert env-alert--danger" hidden><br>              &lt;span data-error-holder>&lt;/span><br>              &lt;button type="button" class="env-alert__close env-button env-button--link env-button--icon env-button--icon-small" data-dismiss="alert"><br>                Close<br>                &lt;svg class="env-icon env-icon--xx-small"><br>                  &lt;use href="/sitevision/envision-icons.svg#icon-delete">&lt;/use><br>                &lt;/svg><br>              &lt;/button><br>            &lt;/div><br>          &lt;/div><br>          &lt;footer id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>fid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" class="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CLASS_BASE</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">__footer env-d--flex env-flex--justify-content-between"><br>            &lt;button type="button" data-modal-dialog-dismiss class="env-button env-m-left--a"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>closeText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/button><br>          &lt;/footer><br>        &lt;/section><br>      &lt;/div><br>    &lt;/div></span><span class="token template-punctuation string">`</span></span><br>    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>initialContentError<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderError</span><span class="token punctuation">(</span>initialContentError<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    Events<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>eid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'[data-dismiss="alert"]'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderError</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>initialContent <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>initialContent<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">isOpen</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token operator">?.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">'env-modal-dialog--show'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">/**<br>   * @param {string} title <br>   */</span><br>  <span class="token function">updateTitle</span> <span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thid<span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> title<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">/**<br>   * @param {string} html <br>   */</span><br>  <span class="token function">updateContent</span> <span class="token punctuation">(</span><span class="token parameter">html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cid<span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">/**<br>   * @param {boolean} isLoading <br>   */</span><br>  <span class="token function">setLoading</span> <span class="token punctuation">(</span><span class="token parameter">isLoading</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>isLoading<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lid<span class="token punctuation">)</span><span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SPINNER_CLASS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">--hide</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isLoading<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">setDisabled</span> <span class="token punctuation">(</span><span class="token parameter">isDisabled</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>isDisabled <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>isDisabled<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>inert <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isDisabled<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cid<span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isDisabled <span class="token operator">?</span> <span class="token number">0.5</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'.env-button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">btn</span><span class="token punctuation">)</span> <span class="token operator">=></span> btn<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isDisabled<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <br>  <span class="token comment">/**<br>   * @param {string} errorMessage <br>   */</span><br>  <span class="token function">renderError</span> <span class="token punctuation">(</span><span class="token parameter">errorMessage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> hasError <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>errorMessage<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> errorElement <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>eid<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    errorElement<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'[data-error-holder]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> errorMessage<span class="token punctuation">;</span><br>    errorElement<span class="token punctuation">.</span>hidden <span class="token operator">=</span> <span class="token operator">!</span>hasError<span class="token punctuation">;</span><br><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cid<span class="token punctuation">)</span><span class="token punctuation">.</span>hidden <span class="token operator">=</span> hasError<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">onClose</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// TODO: should probably start using new Dialog api instead of old ModalDialog so we can </span><br>      <span class="token comment">// remove jQuery as a dependency.</span><br>      <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'hide.env-modal-dialog'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">onClosed</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// TODO: should probably start using new Dialog api instead of old ModalDialog so we can </span><br>      <span class="token comment">// remove jQuery as a dependency.</span><br>      <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'hidden.env-modal-dialog'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">hide</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token constant">ENVISION</span><span class="token punctuation">.</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">'hide'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>callback <span class="token operator">?</span> <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">/**<br>   * @param {Function} callback Callback run when Envision.dialog promise has finished.<br>   * @returns {Dialog}<br>   */</span><br>  <span class="token function">toggle</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token constant">ENVISION</span><span class="token punctuation">.</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string">'#'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">'toggle'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>callback <span class="token operator">?</span> <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span><br><br>  <span class="token function">remove</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">el</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> Dialog<span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * @returns {Record&lt;string,Dialog>}<br> */</span><br><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getCache</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> instances <span class="token operator">=</span> window<span class="token punctuation">.</span>__BookmarkletDialogInstances <span class="token operator">=</span> window<span class="token punctuation">.</span>__BookmarkletDialogInstances <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> instances<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> instances<span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * @returns {Dialog}<br> */</span><br><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getInstance</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dialogId<span class="token punctuation">,</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> instances <span class="token operator">=</span> <span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instances<span class="token punctuation">[</span>dialogId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    instances<span class="token punctuation">[</span>dialogId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>opts<span class="token punctuation">,</span> dialogId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> instances<span class="token punctuation">[</span>dialogId<span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">removeInstance</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dialogId</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> instances <span class="token operator">=</span> <span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>instances<span class="token punctuation">[</span>dialogId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    instances<span class="token punctuation">[</span>dialogId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">delete</span> instances<span class="token punctuation">[</span>dialogId<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
        </div><div class="mb-6">
          <h3 class="is-size-5">uid.js</h3>
          <pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">uid</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token string">'-'</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
        </div><div class="mb-6">
          <h3 class="is-size-5">Switch.js</h3>
          <pre class="language-js"><code class="language-js"><span class="token keyword">import</span> createElement <span class="token keyword">from</span> <span class="token string">"./create-element"</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> Events <span class="token keyword">from</span> <span class="token string">"./Events"</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> uid <span class="token keyword">from</span> <span class="token string">"./uid"</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Switch</span> <span class="token punctuation">{</span><br>  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> label<span class="token punctuation">,</span> description<span class="token punctuation">,</span> changeCallback<span class="token punctuation">,</span> checkCallback <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">=</span> label<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>description <span class="token operator">=</span> description<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>changeCallback <span class="token operator">=</span> changeCallback<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>checkCallback <span class="token operator">=</span> checkCallback<span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token function">uid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">check</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkCallback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">init</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> checked <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'checked'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> description <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>description <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;p class="env-text" style="margin: 0 0 var(--env-spacing-x-large) calc(2.625em + var(--env-spacing-x-small))"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>el <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span><br>    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div class="env-form-field"><br>      &lt;div class="env-form-control"><br>        &lt;input class="env-switch" type="checkbox" id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" name="switches" </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>checked<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> /><br>        &lt;label class="env-form-label" for="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>label<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/label><br>      &lt;/div><br>      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>    &lt;/div></span><span class="token template-punctuation string">`</span></span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    Events<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeCallback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">appendTo</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    target<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> Switch<span class="token punctuation">;</span></code></pre>
        </div></div>
  </div>
</div>

      </main><!--! .page-main -->

      <footer class="page-footer section has-background-secondary-dark has-text-white py-5">
        <div class="container">
          <p class="has-text-centered">
            <a class="page-footer__link has-text-white" href="https://github.com/hampusn/bookmarklets#readme">
              <strong>bookmarklets</strong>
              <svg class="icon" aria-label="External link"><use href="/assets/img/icons.svg?v=0.12.1#mdi-open-in-new"></use></svg>
            </a>
            is created by
            <a class="page-footer__link has-text-white" href="https://hampus.io/">
              <strong>Hampus Nordin</strong>
              <svg class="icon" aria-label="External link"><use href="/assets/img/icons.svg?v=0.12.1#mdi-open-in-new"></use></svg>
            </a>
          </p>
        </div>
      </footer><!--! .page-footer -->
    </div><!--! .page -->

    <div id="bookmarklet-drag" class="bookmarklet-drag"></div>
    <script type="module" src="/assets/js/main.js?v=0.12.1"></script>
    <!-- Current page: /sitevision-development/ -->
  </body>
</html>
